[
  {
    "title": "$:/plugins/danielo515/tiddlypouch",
    "description": "tiddlypouch for TiddlyWiki",
    "author": "Danielo Rodriguez",
    "core-version": ">=5.1.14",
    "list": "readme",
    "version": "0.20.1-2",
    "released": "Sat, 04 Feb 2017 18:15:30 GMT",
    "plugin-type": "plugin",
    "dependents": "",
    "type": "application/json",
    "text": "{\n    \"tiddlers\": {\n        \"$:/plugins/danielo515/tiddlypouch/boot\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/boot\",\n            \"tags\": \"$:/tags/RawMarkup\",\n            \"text\": \"<style>\\r\\n    #TP_splash_screen {\\r\\n         position: fixed;\\r\\n         top: 0;\\r\\n         left: 0;\\r\\n         width: 100%;\\r\\n         height: 100%;\\r\\n         background-color: #FFF;\\r\\n         margin: 0;\\r\\n         font-size: 14px;\\n\\n        -webkit-transition: opacity 2s ease-in-out;\\r\\n        -moz-transition: opacity 2s ease-in-out;\\r\\n        -ms-transition: opacity 2s ease-in-out;\\r\\n        -o-transition: opacity 2s ease-in-out;\\r\\n        transition: opacity 2s ease-in-out;\\r\\n    }\\r\\n    #TP_splash_screen>h1{\\r\\n       text-align: center;\\r\\n       color: #CECECE;\\r\\n       font-size: 5.5em;\\n\\n       width: 100%;\\r\\n       position: relative;\\r\\n       word-wrap: break-word;\\r\\n       font-weight: 300;\\r\\n       margin: 0.67em 0;\\r\\n       line-height: 1.2;\\r\\n       font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, \\\"Lucida Grande\\\", \\\"DejaVu Sans\\\", sans-serif;\\r\\n       text-rendering: optimizeLegibility;\\r\\n      -webkit-font-smoothing: antialiased;\\r\\n      -webkit-box-sizing: border-box;\\r\\n      box-sizing: border-box;\\n\\n\\r\\n    }\\r\\n    @media (min-width: 1200px) {\\r\\n        #TP_splash_screen>h1 {\\r\\n            font-size: 12em;\\r\\n        }\\r\\n    }\\r\\n    #TP_splash_screen>h1:before {\\r\\n        content: attr(data-text);\\r\\n        overflow: hidden;\\r\\n        position: absolute;\\r\\n        max-width: 5.5em;\\r\\n        white-space: nowrap;\\r\\n        color: #93cf93;\\r\\n        animation: loading 6s linear;\\r\\n    }\\r\\n    @keyframes loading {\\r\\n        0% {\\r\\n            max-width: 0;\\r\\n        }\\r\\n    }\\n\\n</style>\\n\\n\\r\\n<script>\\r\\n    (function(window){\\r\\n        'use strict';\\r\\n        /***** Base TiddlyPouch module creation ****/\\r\\n        var $TPouch = window.$TPouch || Object.create(null);\\r\\n        if($TPouch.supressBoot){ /** Allow external JS to avoid boot */\\r\\n            return\\r\\n        }\\r\\n        $TPouch._configDb = $TPouch._configDb || new PouchDB('__TP_config');\\r\\n        $TPouch.splashScreen = $TPouch.splashScreen || Object.create(null);\\r\\n        /*** The version section is automatically updated by build scripts,  Dont delete the below comment */\\r\\n        $TPouch.VERSION = /***TPOUCH_VER*/'0.20.1-2'/*TPOUCH_VER***/;\\n\\n        var $tw = window.$tw || Object.create(null);\\r\\n        $tw.boot = $tw.boot || Object.create(null);\\r\\n        $tw.boot.suppressBoot = true\\n\\n        window.$TPouch = $TPouch;\\r\\n        window.$tw = $tw;\\n\\n        /** Creates a new message node to be used on the splashScreen*/\\r\\n        function createSplashMessageNode(message){\\n\\n            var h1 = document.createElement(\\\"h1\\\");\\r\\n            h1.setAttribute(\\\"data-text\\\",message);\\r\\n            var text = document.createTextNode(message);\\r\\n            h1.appendChild(text);\\r\\n            return h1;\\r\\n        }\\n\\n        function createSplashScreen(message){\\n\\n            /* This function waits until document.body exists*/\\r\\n            function tryToAppend(node){\\r\\n                if(!document.body){\\r\\n                    return setTimeout(tryToAppend.bind(null,node),1);\\r\\n                }\\r\\n                document.body.appendChild( node, document.body.firstChild );\\r\\n            }\\n\\n            var splash = document.getElementById('TP_splash_screen');\\r\\n            if( splash === null){\\r\\n                splash = document.createElement(\\\"div\\\");\\r\\n                splash.setAttribute(\\\"id\\\",\\\"TP_splash_screen\\\");\\r\\n                splash.appendChild(createSplashMessageNode(message));\\r\\n                tryToAppend(splash);\\r\\n            } else{\\r\\n                splashMessage(message);\\r\\n            }\\n\\n            $TPouch.splashScreen.node = splash;\\r\\n        }\\r\\n        /** Hides the splash screen allowing the cool css animation to execute*/\\r\\n        $TPouch.splashScreen.hide = function hideSplashScreen(){\\r\\n            /** We first set opacity to 0 to allow the css animations kick in\\r\\n             * Two seconds later , when animation has finished\\r\\n             * we set display to none so it does not takes space on the page.\\r\\n             * Display none can not be animated, that's why we use opacity first.\\r\\n            */\\r\\n            $TPouch.splashScreen.node.style.opacity = 0;\\r\\n            setTimeout( function(){\\n\\n                $TPouch.splashScreen.node.style.display = \\\"none\\\";\\r\\n            } ,2000);\\n\\n        };\\r\\n        $TPouch.splashScreen.showMessage = function splashMessage(message){\\n\\n            var node = $TPouch.splashScreen.node;\\r\\n            node.replaceChild(createSplashMessageNode(message), node.firstChild)\\r\\n            node.style.display = \\\"block\\\";\\r\\n            node.style.opacity = 1;\\r\\n        };\\n\\n        /**\\r\\n         * Checks if the current version on the database is lower than the current version\\r\\n         * if so, it deletes all the indexes so they can be recreated\\r\\n         * @param {string} version - The version of TiddlyPouch that the database being updated has\\r\\n         * @param {PouchDB} db - The actual Pouch database that we are updating\\r\\n         * @returns {promise} - promise that fulfills when all the indexes have been processed, removed or failed removing\\r\\n         */\\r\\n            function updater(version, db) {\\n\\n                var documentsToRemove = [\\r\\n                    '_design/by_type', '_design/skinny_tiddlers',\\r\\n                    '_design/by_plugin_type' , '_design/filtered_replication',\\r\\n                    '_design/TiddlyPouch','_design/startup_tiddlers'\\r\\n                    ];\\n\\n                if (version && !(parseInt(version.split('.').join('')) < parseInt($TPouch.VERSION.split('.').join('')))) {\\r\\n                    return Promise.resolve();\\r\\n                }\\r\\n                console.log('Starting update process...');\\r\\n                $TPouch.splashScreen.showMessage('Updating database');\\r\\n                return Promise.all(\\r\\n                    documentsToRemove\\r\\n                        .map(function (doc) {\\n\\n                            return db.get(doc)\\r\\n                                .then(function (docu) {\\r\\n                                    console.log('Removing index ', doc);\\r\\n                                    return db.remove(docu)\\r\\n                                })\\r\\n                                .catch(console.log.bind(console, 'Error removing ', doc))\\r\\n                        })\\r\\n                    )\\r\\n                    .then(function () {\\r\\n                        console.log('Update process complete');\\r\\n                    });\\r\\n            }\\n\\n\\n\\n        createSplashScreen('Loading');\\n\\n        $TPouch._configDb.get('configuration') // we read the configuration to know which database shuld be loaded\\r\\n        .then(function(config){\\n\\n            if(!config.selectedDbId){\\r\\n                throw new Error('There is no DB selected, nothing to inject')\\r\\n            }\\r\\n            /** Create the default db, it should be wrapped later on the boot proces in a {@link DbStore} */\\r\\n            $TPouch._db = new PouchDB(config.selectedDbId);\\r\\n            var oldVer = config.databases[config.selectedDbId].version;\\r\\n            return updater(oldVer , $TPouch._db)\\r\\n                    .then(function(){ /** After the update process, flag the db with latest version */\\r\\n                        config.databases[config.selectedDbId].version = $TPouch.VERSION;\\r\\n                        return $TPouch._configDb.put(config);\\r\\n                    })\\r\\n        })\\r\\n        .then(function(){\\n\\n            return $TPouch._db.query('startup_tiddlers', { include_docs: true })\\r\\n        })\\r\\n        .then(function(all){ //Actual docs are contained in the rows array\\n\\n            console.log('Injecting ', all.total_rows, ' startup tiddlers into tw');\\r\\n            var startupTids = all.rows.map(function(row){\\n\\n                return row.doc.fields\\r\\n            });\\r\\n            window.$tw.preloadTiddlers = startupTids;\\r\\n        }).catch(function(reason){ // catch any possible error and continue the chain\\n\\n            console.log('Something went wrong during plugin injection ', reason);\\r\\n        }).then(function(){\\r\\n            try{\\r\\n                $tw.boot.boot(); // boot when chain completes, even if we got some errors\\r\\n            }catch(err){\\r\\n                console.error('Something went wrong booting tiddlywiki ',err);\\r\\n                window.location.reload();\\r\\n            }\\n\\n        })\\n\\n\\n\\n    })(window);\\r\\n</script>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/converters/converter.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/converters/converter.js\\ntype: application/javascript\\nmodule-type: library\\n\\nBasic converter. Used by other decorators (AKA converters)\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports.decorate=Converter;function Converter(e){e._mangleTitle=function r(e){if(e.length==0){return e}var r=e.charAt(0);var t=e.substring(1);if(r===\\\"_\\\"){return\\\"%5f\\\"+t}else if(r===\\\"%\\\"){return\\\"%25\\\"+t}else{return e}};return e}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/converters/converter.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/dbstore/factory\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/dbstore/factory\\ntype: application/javascript\\nmodule-type: library\\n\\nA factory of DbStores. This factory is responsible of instantiating the DbStores and inject them the required dependecies\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports=factory;var DbStore=require(\\\"$:/plugins/danielo515/tiddlypouch/DbStore.js\\\");var converters={tiddlers:require(\\\"$:/plugins/danielo515/tiddlypouch/converters/tiddler\\\"),plugins:require(\\\"$:/plugins/danielo515/tiddlypouch/converters/plugins\\\")};function factory(r,e,t){e=e||\\\"tiddlers\\\";var i=converters[e];var o=new DbStore(r,t);return i.decorate(o)}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/dbstore/factory\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/DbStore.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/DbStore.js\\ntype: application/javascript\\nmodule-type: library\\n\\nManages insertions, extractions, deletions of tiddlers to a database.\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports=DbStore;function DbStore(t,e){this.name=t;this._db=e instanceof PouchDB?e:new PouchDB(t);this.logger=new $TPouch.Logger(\\\"DbStore:\\\"+t)}DbStore.prototype._Conflict=function t(e){var r=this;return function(t){if(t.status==409){return r.logger.log(e)}throw t}};DbStore.prototype.destroy=function e(){return this._db.destroy()};DbStore.prototype.createIndex=function r(t,e){var r={_id:\\\"_design/\\\"+t,views:{}};r.views[t]={map:e.toString()};this.logger.debug(\\\"Creating index\\\"+t+\\\"...\\\");return this._db.put(r).then(this.logger.debug.bind(this.logger,\\\"Index \\\"+t+\\\" created\\\")).catch(this._Conflict(\\\"Index \\\"+t+\\\" exists already\\\"))};DbStore.prototype._upsert=function(t){var e=this;return e._db.put(t).then(function(t){return t}).catch(function(r){if(r){if(r.name===\\\"conflict\\\"){e.logger.debug(\\\"O my gosh, update conflict!\\\");return e._db.get(t._id).then(function(t){e.logger.log(\\\"A real update conflict!\\\",t);throw r}).catch(function(r){if(r.name===\\\"not_found\\\"){e.logger.debug(\\\"Fake conflict, trying again\\\",t);t._rev=null;return e._db.put(t)}})}throw r}})};DbStore.prototype._validateRevision=function n(t){if(/\\\\d+-[A-z0-9]*/.test(t)){return t}return null};DbStore.prototype.addTiddler=function(t,e){var r=this;var n=this._convertToCouch(t,e.tiddlerInfo);this.logger.debug(\\\"Saving \\\",n);return r._upsert(n)};DbStore.prototype.deleteTiddler=function(t){var e=this;var r=e._mangleTitle(t);return e._db.get(r).then(function(t){t._deleted=true;return e._db.put(t)}).catch(e.logger.log.bind(e.logger,\\\"Something went wrong deleting \\\"+t))};DbStore.prototype.getTiddler=function(t,e){var r=this;var n=[r._mangleTitle(t)];if(r._validateRevision(e)){n.push({rev:e})}r.logger.debug(\\\"Retrieving tiddler \\\",t,\\\" from database\\\");return r._db.get.apply(r._db,n).then(r._convertFromCouch.bind(r)).catch(function(e){r.logger.log(\\\"Error getting tiddler \\\"+t+\\\" from DB\\\",e);throw e})};DbStore.prototype.getTiddlers=function(t,e,r){var n=this;var o={include_docs:undefined===r?true:r};if(e){o.key=e}return n._db.query(t,o).then(function(r){n.logger.trace(\\\"Query to \\\",t,\\\" searching for \\\",e,\\\" : \\\",r.rows);return r.rows}).then(function(t){return t.map(function(t){return t.doc?t.doc:{_id:t.id,fields:t.value}})}).then(function(t){return t.map(n._convertFromCouch.bind(n))}).catch(n.logger.log.bind(n.logger))};DbStore.prototype.getTiddlerRevisions=function(t){return this._db.get(this._mangleTitle(t),{revs_info:true}).then(function(t){var n=t._revs_info.filter(e).map(r);return n});function e(t){return t.status===\\\"available\\\"}function r(t){return t.rev}};\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/DbStore.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/converters/plugins\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/converters/plugins\\ntype: application/javascript\\nmodule-type: library\\n\\nDecorator that convert tiddlywiki plugins into PouchDB documents\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports.decorate=pluginConverter;var BaseConverter=require(\\\"$:/plugins/danielo515/tiddlypouch/converters/converter.js\\\");function pluginConverter(e){e=BaseConverter.decorate(e);e._convertToCouch=function t(e,r){var i={fields:{}};if(e){$tw.utils.each(e.fields,function(t,r){if(r===\\\"revision\\\"){return}i.fields[r]=e.getFieldString(r)});i.fields.tags=e.fields.tags}i.fields.type=i.fields.type||\\\"text/vnd.tiddlywiki\\\";i._id=this._mangleTitle(e.fields.title);i._rev=e.fields.revision;if(r.adaptorInfo&&r.adaptorInfo._rev){i._rev=r.adaptorInfo._rev}i._rev=this._validateRevision(i._rev);return i};e._convertFromCouch=function r(){var e=new Error(\\\"Tiddlers should not be loaded from the plugins database!\\\");e.status=403;throw e};e.deleteTiddler=function(){var e=new Error(\\\"Tiddlers should not be deleted through the plugins database!\\\");e.status=403;throw e};return e}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/converters/plugins\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/converters/tiddler\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/converters/tiddler\\ntype: application/javascript\\nmodule-type: library\\n\\na conversor that makes tiddlers compatible with pouchdb. This injects the required methods into the db store to handle conversions between regular tiddlers and couchdb\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports.decorate=tiddlerConverter;var BaseConverter=require(\\\"$:/plugins/danielo515/tiddlypouch/converters/converter.js\\\");function tiddlerConverter(e){e=BaseConverter.decorate(e);e._convertToCouch=function t(e,i){var r={fields:{}};if(e){$tw.utils.each(e.fields,function(t,i,n){if(i===\\\"revision\\\"){return}if(i===\\\"_attachments\\\"&&!e.isDraft()){r._attachments=t;return}r.fields[i]=e.getFieldString(i)});r.fields.tags=e.fields.tags}r.fields.type=r.fields.type||\\\"text/vnd.tiddlywiki\\\";r._id=this._mangleTitle(e.fields.title);r._rev=e.fields.revision;if(i.adaptorInfo&&i.adaptorInfo._rev){r._rev=i.adaptorInfo._rev}r._rev=this._validateRevision(r._rev);return r};e._convertFromCouch=function i(e){var t={};this.logger&&this.logger.debug(\\\"Converting from \\\",e);$tw.utils.each(e,function(i,r,n){if(r===\\\"fields\\\"){$tw.utils.each(i,function(e,i,r){t[i]=e})}else if(r===\\\"_id\\\"||r===\\\"_rev\\\"){}else{t[r]=e[r]}});e._rev&&(t.revision=e._rev);return t};e.getSkinnyTiddlers=function(){return this.getTiddlers(\\\"skinny_tiddlers\\\",null,false)};return e}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/converters/tiddler\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/images/revisions\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/images/revisions\",\n            \"text\": \"<svg class=\\\"tc-image-file tc-image-button\\\" width=\\\"22pt\\\" height=\\\"22pt\\\" viewBox=\\\"-12 0 128 128\\\">\\r\\n <g>\\r\\n  <path stroke-opacity=\\\"0\\\" id=\\\"svg_18\\\" d=\\\"m8,125.96423l84,1l2,-95l-25,-25l-60,2l-1,117z\\\" stroke-linecap=\\\"square\\\" stroke-linejoin=\\\"round\\\" stroke-dasharray=\\\"null\\\" stroke-width=\\\"4\\\" stroke=\\\"#000000\\\"/>\\r\\n  <g id=\\\"svg_1\\\" fill-rule=\\\"nonzero\\\">\\r\\n   <path d=\\\"m98.96811,33.5l0.03189,0l0,89.49908c0,4.41879 -3.58089,8.00092 -7.99925,8.00092l-80.0015,0c-4.41787,0 -7.99925,-3.58231 -7.99925,-8.00092l0,-111.99816c0,-4.41879 3.58089,-8.00092 7.99925,-8.00092l57.00075,0l0,0.02018c2.15899,-0.09171 4.34822,0.6869 5.99825,2.33693l22.62693,22.62693c1.5265,1.5265 2.30776,3.5158 2.34293,5.51596l0,0zm-30.96811,-22.5l-57,0l0,112l80,0l0,-89.5l-14.99965,0c-4.41847,0 -8.00035,-3.57837 -8.00035,-8.00035l0,-14.49965z\\\" id=\\\"svg_2\\\" />\\r\\n   <text stroke-opacity=\\\"0\\\" fill=\\\"#ffffff\\\" x=\\\"43.25633\\\" y=\\\"54.82153\\\" id=\\\"svg_9\\\" font-size=\\\"24\\\" font-family=\\\"Sans-serif\\\" text-anchor=\\\"middle\\\" xml:space=\\\"preserve\\\" transform=\\\"matrix(3.5430981263433354,0,0,3.1603711640014467,-102.24349149601478,-63.365374592008266) \\\" stroke=\\\"#000000\\\" stroke-linejoin=\\\"round\\\" stroke-linecap=\\\"round\\\" font-weight=\\\"bold\\\">R</text>\\r\\n   <rect stroke=\\\"#000000\\\" stroke-opacity=\\\"0\\\" fill=\\\"#ffffff\\\" x=\\\"19\\\" y=\\\"39\\\" width=\\\"64\\\" height=\\\"8\\\" rx=\\\"4\\\" id=\\\"svg_3\\\"/>\\r\\n   <rect stroke-opacity=\\\"0\\\" stroke=\\\"#000000\\\" fill=\\\"#ffffff\\\" x=\\\"19\\\" y=\\\"23\\\" width=\\\"40\\\" height=\\\"8\\\" rx=\\\"4\\\" id=\\\"svg_8\\\"/>\\r\\n  </g>\\r\\n </g>\\r\\n</svg>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/images/cloud-error\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/images/cloud-error\",\n            \"text\": \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" version=\\\"1.1\\\" x=\\\"0\\\" y=\\\"0\\\"\\r\\n    width=\\\"23\\\" height=\\\"23\\\" viewBox=\\\"0 0 512 512\\\" enable-background=\\\"new 0 0 512 512\\\"\\r\\n    xml:space=\\\"preserve\\\">\\r\\n<path d=\\\"M446.3 208.8C447 203.3 448 197.8 448 192c0-70.7-57.3-128-128-128 -41.8 0-78.6 20.3-101.9 51.4C209.7 113.3 201 112 192 112c-61.9 0-112 50.1-112 112 0 1.8 0.4 3.3 0.5 5.1C34.1 242.7 0 285.2 0 336c0 61.9 50.1 112 112 112h272c70.7 0 128-57.3 128-128C512 272.1 485.3 230.8 446.3 208.8zM346.5 333.3l-45.2 45.3L256 333.3l-45.2 45.3 -45.3-45.2L210.8 288l-45.3-45.2 45.3-45.2L256 242.8l45.3-45.2 45.3 45.3L301.3 288 346.5 333.3z\\\"/>\\r\\n</svg>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/images/cloud-ok\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/images/cloud-ok\",\n            \"text\": \"<svg version=\\\"1.1\\\" id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\r\\n\\t width=\\\"22pt\\\" height=\\\"22pt\\\" viewBox=\\\"0 0 512 512\\\" enable-background=\\\"new 0 0 512 512\\\" xml:space=\\\"preserve\\\">\\r\\n<path d=\\\"M319.99,64.012c-41.799,0-78.862,20.378-102.26,51.478-8.3011-2.0992-16.739-3.4783-25.739-3.4783-61.901,0-112,50.1-112,112,0,1.8009-0.08904,3.7652,0,5.5652-46.401,13.6-80,55.635-80,106.43,0,61.9,50.099,112,112,112h272c70.701,0,128-57.3,128-128,0-47.9-27.086-88.609-66.087-110.61,0.71235-5.5,2.0858-11.591,2.0858-17.391,0-70.7-57.299-128-128-128zm79.304,81.391c5.2538-0.001,9.9054,2.1682,13.913,6.2609,7.9992,8.1706,8.0168,21.029,0,29.217l-198.94,203.83c-4.0067,4.0927-9.3542,6.2604-14.609,6.2609-5.2609,0.002-10.594-2.1615-14.609-6.2609l-86.953-88.36c-8.0375-8.2098-8.0155-21.726,0-29.913,7.9992-8.1706,20.498-8.196,28.522,0l73.043,73.739,185.04-188.52c4.0063-4.0922,9.3549-6.2598,14.609-6.2609z\\\"/>\\r\\n</svg>\\r\\n\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/images/cloud-spinning\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/images/cloud-spinning\",\n            \"text\": \"<svg version=\\\"1.1\\\" id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\r\\n\\t width=\\\"22pt\\\" height=\\\"22pt\\\" viewBox=\\\"0 0 512 512\\\" enable-background=\\\"new 0 0 512 512\\\" xml:space=\\\"preserve\\\">\\r\\n<path d=\\\"M446.313,208.813C447.031,203.25,448,197.75,448,192c0-70.688-57.281-128-128-128c-41.813,0-78.594,20.344-101.938,51.375\\r\\n\\tC209.656,113.344,201,112,192,112c-61.875,0-112,50.125-112,112c0,1.75,0.438,3.313,0.5,5.063C34.094,242.719,0,285.156,0,336\\r\\n\\tc0,61.875,50.125,112,112,112h272c70.719,0,128-57.281,128-128C512,272.063,485.344,230.75,446.313,208.813z M128,288h32\\r\\n\\tc0-52.938,43.063-96,96-96c19,0,37.094,5.625,52.344,15.531l-19.438,25.906c-9.766-5.875-21-9.438-32.906-9.438\\r\\n\\tc-35.297,0-64,28.688-64,64h32l-48,64L128,288z M352,288c0,52.938-43.063,96-96,96c-19,0-37.078-5.625-52.359-15.531l19.438-25.906\\r\\n\\tC232.859,348.438,244.094,352,256,352c35.281,0,64-28.688,64-64h-32l48-64l48,64H352z\\\"/>\\r\\n</svg>\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/utils/logger.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/utils/logger.js\\ntype: application/javascript\\nmodule-type: library\\nA basic logging implementation\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";var t=require(\\\"$:/core/modules/utils/logger.js\\\").Logger;function e(e,o,r){t.call(this,e);if(typeof o===\\\"object\\\"){r=o.verbose;o=o.debug}this.isDebug=o;this.isVerbose=r}e.prototype=Object.create(t.prototype);e.prototype.constructor=t;e.prototype.debug=function(){if(!this.isDebug){return}this.log.apply(this,Array.prototype.slice.call(arguments,0))};e.prototype.trace=function(){if(!this.isVerbose){return}this.debug.apply(this,Array.prototype.slice.call(arguments,0))};exports.Logger=e})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/utils/logger.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/pouchadaptor.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/pouchadaptor.js\\ntype: application/javascript\\nmodule-type: syncadaptor\\n\\nA sync adaptor module for synchronising with local PouchDB\\n\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";function PouchAdaptor(t){this.wiki=t.wiki;var e=$TPouch.config.debug;this.logger=new $TPouch.Logger(\\\"PouchAdaptor\\\",e.isActive(),e.isVerbose());this.sessionUrl=$TPouch.config.currentDB.getUrl(\\\"_session\\\")}function httpRequest(t){var e=t.type||\\\"GET\\\",o=t.headers||{accept:\\\"application/json\\\"},n=new XMLHttpRequest,r=\\\"\\\",i;if(t.data){if(typeof t.data===\\\"string\\\"){r=t.data}else{i=[];$tw.utils.each(t.data,function(t,e){i.push(e+\\\"=\\\"+encodeURIComponent(t))});r=i.join(\\\"&\\\")}}if(t.withCredentials){n.withCredentials=true}n.onreadystatechange=function(){if(this.readyState===4){if(this.status===200||this.status===201||this.status===204){t.callback(null,this.responseText,this);return}t.callback(\\\"XMLHttpRequest error code: \\\"+this.status)}};n.open(e,t.url,true);if(o){$tw.utils.each(o,function(t,e,o){n.setRequestHeader(e,t)})}if(r&&!$tw.utils.hop(o,\\\"Content-type\\\")){n.setRequestHeader(\\\"Content-type\\\",\\\"application/x-www-form-urlencoded; charset=UTF-8\\\")}n.send(r);return n}PouchAdaptor.prototype.getStatus=function(t){var e=this;if(!e.sessionUrl){return t(null,false,\\\"NON-AUTHENTICATED\\\")}httpRequest({url:e.sessionUrl,withCredentials:true,callback:function(o,n){if(o){e.logger.debug(\\\"Error during login phase\\\",o);return t(null,false,\\\"NON-AUTHENTICATED\\\")}var r=null;var i=false;var a=null;try{r=JSON.parse(n)}catch(s){}if(r&&r.userCtx){a=r.userCtx.name;i=a!==null;if(!i&&r.userCtx.roles.length==1&&r.userCtx.roles[0]===\\\"_admin\\\"){e.logger(\\\"Warning! Server is on admin party mode!\\\");i=true}}if(i&&!$TPouch.onlineDB){e.login()}t(null,i,a)}})};PouchAdaptor.prototype.getTiddlerInfo=function(t){return{_rev:t.fields.revision}};PouchAdaptor.prototype.getSkinnyTiddlers=function(t){$TPouch.database.getSkinnyTiddlers().then(t.bind(null,null)).catch(t)};PouchAdaptor.prototype.saveTiddler=function(t,e,o){this.logger.trace(\\\"Tiddler info \\\",o.tiddlerInfo);$TPouch.router.route(t,o).addTiddler(t,o).then(function(t){e(null,{_rev:t.rev},t.rev)}).catch(e)};PouchAdaptor.prototype.loadTiddler=function(t,e){$TPouch.database.getTiddler(t).then(e.bind(null,null)).catch(e)};PouchAdaptor.prototype.deleteTiddler=function(t,e,o){if(!o.tiddlerInfo||!o.tiddlerInfo.adaptorInfo||typeof o.tiddlerInfo.adaptorInfo._rev==\\\"undefined\\\"){e(null)}$TPouch.database.deleteTiddler(t).then(e.bind(e,null)).catch(e)};PouchAdaptor.prototype.isReady=function(){return true};PouchAdaptor.prototype.login=function(t,e,o){var n=this;n.logger.log(\\\"Trying to sync...\\\");var r=$TPouch.newOnlineDB({username:t,password:e});if(!r){n.logger.log(\\\"Warning, sync is not possible because no onlineDB\\\");return o(\\\"There is no online DB set\\\")}$TPouch.onlineDB=r;$TPouch.startSync(r).then(o)};PouchAdaptor.prototype.logout=function(t){var e=this;var o={url:e.sessionUrl,type:\\\"DELETE\\\",withCredentials:true,callback:function(e){t(e)}};httpRequest(o)};if($tw.browser&&$TPouch.database){exports.adaptorClass=PouchAdaptor}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/pouchadaptor.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"syncadaptor\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/readme\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/readme\",\n            \"text\": \"This is tiddlypouch plugin for [[TiddlyWiki|tiddlywiki.com]].\\r\\nThis plugin uses PouchDB library to provide a store for your tiddlers. \\r\\nTiddlers are saved to the built-in database of your browser. It is also possible to setup a remote\\r\\ndatabase and make tiddlypouch sync your local database with the remote one! This allows you very\\r\\ninteresting workflows like ''working offline'' and syn back to the server when you come back online.\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/database/router.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/database/router.js\\ntype: application/javascript\\nmodule-type: library\\n\\nRoutes tiddlers between databases. What it actually does is return the destination database for a given tiddler.\\nIt is the responsability of the entity that is requesting the routing to act on that destination.\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports=DbRouter;function defaultRouter(t){if(this.destinations.default){return\\\"default\\\"}throw new Error(\\\"There is no default route set!\\\")}var defaultRoute={name:\\\"default\\\",canRoute:function(){return true},route:defaultRouter};function DbRouter(t){this.destinations={\\\"default\\\":t};this.routes=[defaultRoute]}DbRouter.createRouter=function(t){return new DbRouter(t)};DbRouter.prototype.addRoute=function(t){if(typeof t===\\\"object\\\"&&typeof t.canRoute===\\\"function\\\"&&typeof t.route===\\\"function\\\"){this.routes.push(t);return this}var e=new Error('Invalid route. Routes should include \\\"canRoute\\\" and \\\"route\\\" methods');throw e};DbRouter.prototype.addDestination=function(t,e){this.destinations[t]=e;return this};DbRouter.prototype.findRoute=function(t){for(var e=this.routes.length-1;e>-1;--e){var o=this.routes[e];if(o.canRoute.call(this,t)){return o}}};DbRouter.prototype.route=function(t){var e=this.findRoute(t);var o=e.route.call(this,t);return this.destinations[o]};\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/database/router.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/database/routes\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/database/routes\\ntype: application/javascript\\nmodule-type: library\\n\\nsome routes for the DbRouter class\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";module.exports.plugins={name:\\\"plugins\\\",route:function(n){return\\\"__TP_plugins\\\"},canRoute:function(n){return n&&n.isPlugin&&n.isPlugin()}};\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/database/routes\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/savers/DownloadCurrentDB\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/savers/DownloadCurrentDB\\ntype: application/javascript\\nmodule-type: saver\\n\\nSaves all the tiddlers on the current database as JSON\\n\\n@preserve \\n\\n\\\\*/\\n(function(){\\\"use strict\\\";var e=require(\\\"$:/plugins/danielo515/tiddlypouch/utils\\\");function n(e){this.downloader=require(\\\"$:/core/modules/savers/download.js\\\").create(e)}n.prototype.save=function(e,n,o){var r={variables:{filename:$TPouch.config.currentDB.getName()+\\\".json\\\"}};var t=[];var a=this;Promise.all([$TPouch.database._db.allDocs({include_docs:true,endkey:\\\"_design\\\"}),$TPouch.database._db.allDocs({include_docs:true,startkey:\\\"_designï¿¿\\\"})]).then(function(e){return e[0].rows.concat(e[1].rows)}).then(function(e){e.forEach(function(e){t.push($TPouch.database._convertFromCouch(e.doc))});var c=JSON.stringify(t,null,$tw.config.preferences.jsonSpaces);a.downloader.save(c,n,o,r)});return true};n.prototype.info={name:\\\"Download current db\\\",priority:100,capabilities:[\\\"save\\\",\\\"download\\\"]};exports.canSave=function(e){return $TPouch.database!==undefined};exports.create=function(e){return new n(e)}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/savers/DownloadCurrentDB\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"saver\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/config/single-db-config\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/config/single-db-config\\ntype: application/javascript\\nmodule-type: library\\n\\n\\n@preserve\\n\\n\\\\*/\\nmodule.exports=dbConfig;function dbConfig(e,t){if(typeof e===\\\"object\\\"){t=e.remote;e=e.name}this.name=e;this.remote={};if(typeof t===\\\"object\\\"){this.remote.name=t.name;this.remote.url=t.url;this.remote.username=t.username}}dbConfig.prototype.getName=function(){return this.name};dbConfig.prototype.getRemoteName=function(){var e=this.remote&&this.remote.name;return e};dbConfig.prototype.getConfig=function(){return{name:this.name,remote:this.remote}};dbConfig.prototype.getUrl=function e(t){var o=this.remote.url;if(!o){return null}o=o.substr(-1)===\\\"/\\\"?o:o+\\\"/\\\";if(t){o+=t}return o};\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/config/single-db-config\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/remove-splash.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/remove-splash.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nThe only purpose of this startup module is removing the splash screen.\\nWe do it on a startup module that is executed as later as possible on the\\nboot process, so we remove the loading message when the wiki has loaded fully,\\nand not before.\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";exports.name=\\\"TiddlyPouch-remove-splash\\\";exports.after=[\\\"startup\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=true;exports.startup=function(){$TPouch.splashScreen.hide()};\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/remove-splash.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/config.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/config.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nModule responsible of managing the config.\\nCreates and reads the config database.\\nProvides an interface to the configurations (get, set, update)\\nConfiguration should be inmutable and require a reboot to become active\\nOnly remote configuration (username, remote_name, url) may be changed in the running session.\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";exports.name=\\\"TiddlyPouch-config\\\";exports.before=[\\\"pouchdb\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=false;var e=\\\"$:/plugins/danielo515/tiddlypouch/config/\\\";var t=e+\\\"config_database\\\";exports.startup=function(e){var n=require(\\\"$:/plugins/danielo515/tiddlypouch/utils/logger.js\\\",true).Logger;var i=new n(\\\"TiddlyPouch:config\\\");var r=require(\\\"$:/plugins/danielo515/tiddlypouch/ui/config.js\\\");var o=require(\\\"$:/plugins/danielo515/tiddlypouch/config/single-db-config\\\");var u;var a;var c;function d(){var e={debug:{active:true,verbose:false},selectedDbId:\\\"MyNotebook\\\",databases:{}};var n;try{n=JSON.parse($tw.wiki.getTiddler(t).fields.text)}catch(i){console.log(\\\"No tiddler config, using default\\\");n=e}return n}function s(e){var n=e||u;var i=JSON.stringify(n);$tw.wiki.addTiddler(new $tw.Tiddler({title:t,type:\\\"application/json\\\",text:i}));return true}function f(e){var t=$tw.utils.extend({},u,e);if(!t||!p(t)){i.log(\\\"Updating config to DB - ERROR\\\",\\\"Tried to persist an invalid config\\\");return}return g(t).then(s).then(function(){$tw.rootWidget&&$tw.rootWidget.dispatchEvent({type:\\\"tm-tp-config-saved\\\",param:true})})}function g(e){var t=$tw.utils.extend({},e);t._id=t._id||\\\"configuration\\\";return a.put(t).then(function(e){i.log(\\\"Persist config to DB - OK\\\",e);return l()}).catch(i.log.bind(i,\\\"Persist config to DB - ERROR\\\"))}function l(){return a.get(\\\"configuration\\\").then(function(e){if(p(e)){return e}throw new Error(\\\"Config was read, but it was invalid\\\")}).catch(function(e){i.log(\\\"Config read from DB - ERROR\\\",e);throw e})}function p(e){var t=false;t=!!(e&&e.debug);t=!!(e&&e.selectedDbId);return t}function b(e){var t={name:e,remote:{name:null,username:null,ur:null}};u.databases[e]=u.databases[e]||t;return u.databases[e]}function h(){var e=[];$tw.utils.each(u.databases,function(t){e.push(t.name)});return e}function v(){return u.debug.active}function w(){return u.debug.verbose}function $(){a=$TPouch._configDb;i.log(\\\"Initializing config module\\\");return l().then(function(e){i.debug(\\\"Config read from DB - OK\\\");u=e;s()}).catch(function(e){i.debug(\\\"FallingBack to tiddler configuration\\\");u=d();return u}).then(function(){c=new o(b(u.selectedDbId));return f()})}return $().then(function(){$TPouch.Logger=n;$TPouch.DbStore=require(\\\"$:/plugins/danielo515/tiddlypouch/dbstore/factory\\\");$TPouch.config={getAllDBNames:h,readConfigTiddler:d,getDatabaseConfig:b,update:f,selectedDB:u.selectedDbId,_configDB:a,_config:u,debug:{isActive:v,isVerbose:w},currentDB:c};r.refreshUI(u);i.log(\\\"Configuration startup finished\\\",u);e()})}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/config.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/event-listeners.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/event-listeners.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nThis module creates the basic structure needed for the plugin.\\nThis included the TiddlyPouch Object namespace and the local database\\nThe existence of the database determines if the plugin will be active or not.\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";exports.name=\\\"TiddlyPouch-eventListeners\\\";exports.after=[\\\"startup\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=true;exports.startup=function(){var e=new $TPouch.Logger(\\\"TiddlyPouch\\\");var t=require(\\\"$:/plugins/danielo515/tiddlypouch/ui/config.js\\\");var a=require(\\\"$:/plugins/danielo515/tiddlypouch/utils\\\");$tw.rootWidget.addEventListener(\\\"tm-pouch-delete-db\\\",function(t){$tw.passwordPrompt.createPrompt({serviceName:$tw.language.getString(\\\"TiddlyPouch/Delete-DB\\\",{variables:{database:$TPouch.config.currentDB.name}}),noUserName:true,submitText:\\\"Confirm\\\",canCancel:true,repeatPassword:false,callback:function(t){if(t&&t.password===\\\"delete\\\"){$TPouch.database.destroy().then(function(){e.alert(\\\"Database \\\",$TPouch.config.currentDB.name,\\\" deleted!!!\\\")})}return true}})});$tw.rootWidget.addEventListener(\\\"tm-tp-load-revisions\\\",function(e){$TPouch.database.getTiddlerRevisions(e.param).then(function(t){var n=\\\"$:/temp/revisions:\\\"+e.param;a.saveAsJsonTiddler(n,t)})});$tw.rootWidget.addEventListener(\\\"tm-tp-load-certain-revision\\\",function(e){$TPouch.database.getTiddler(e.param,e.paramObject.revision).then(function(t){t.title=\\\"$:/temp/revision:\\\"+e.paramObject.revision.slice(0,6)+\\\":\\\"+e.param;$tw.wiki.addTiddler(t)})});$tw.rootWidget.addEventListener(\\\"tm-tp-config-saved\\\",function(){var e=confirm(\\\"Configuration has been changed and saved. It is necessary to reload the window. Are you Ok with it?\\\");e&&location.reload()});$tw.rootWidget.addEventListener(\\\"tp-sync-state\\\",t.setSyncFlag);$tw.rootWidget.addEventListener(\\\"tm-TP-config-selectedDb\\\",t.handlers.databaseHasBeenSelected);$tw.rootWidget.addEventListener(\\\"tm-TP-config-updateDebug\\\",t.handlers.updateDebug);$tw.rootWidget.addEventListener(\\\"tm-TP-config-updateSelectedDB\\\",t.handlers.updateDbConfig)}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/event-listeners.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/pouch.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/pouch.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nThis module creates the basic structure needed for the plugin.\\nThis included the TiddlyPouch Object namespace and the local database\\nThe existence of the database determines if the plugin will be active or not.\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";exports.name=\\\"pouchdb\\\";exports.before=[\\\"startup\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=false;exports.startup=function(e){var t=new $TPouch.Logger(\\\"PouchStartup\\\");var i=require(\\\"$:/plugins/danielo515/tiddlypouch/database/router.js\\\");var o=require(\\\"$:/plugins/danielo515/tiddlypouch/database/routes\\\");$TPouch._db=$TPouch._db||new PouchDB($TPouch.config.currentDB.name);$TPouch.database=$TPouch.DbStore($TPouch.config.currentDB.name,\\\"tiddlers\\\",$TPouch._db);$TPouch.plugins=$TPouch.DbStore(\\\"__TP_plugins\\\",\\\"plugins\\\",$TPouch._db);$TPouch.router=i.createRouter($TPouch.database);$TPouch.router.addRoute(o.plugins).addDestination(\\\"__TP_plugins\\\",$TPouch.plugins);t.log(\\\"Client side dbs created\\\");if($TPouch.config.debug.isActive()){$TPouch.database._db.on(\\\"error\\\",function(e){t.log(e);debugger})}Promise.all([$TPouch.database.createIndex(\\\"skinny_tiddlers\\\",function(e){if(e.fields[\\\"plugin-type\\\"]){return}var t={};for(var i in e.fields){if([\\\"text\\\"].indexOf(i)===-1){t[i]=e.fields[i]}}t.revision=e._rev;emit(e._id,t)}),$TPouch.database.createIndex(\\\"startup_tiddlers\\\",function(e){e.fields&&(e.fields.tags&&e.fields.tags.indexOf(\\\"$:/tags/Macro\\\")!==-1||e.fields.type===\\\"application/javascript\\\"||!!e.fields[\\\"plugin-type\\\"])&&emit(e.id)})]).catch(function(e){t.log(\\\"Something went wrong during index creation\\\",e)}).then(function(){return $TPouch.database.getTiddler(\\\"$:/StoryList\\\")}).then(function(e){$tw.wiki.addTiddler(e);t.debug(\\\"StoryList was already in database \\\",e);return $TPouch.database.getTiddler(\\\"$:/DefaultTiddlers\\\")}).then(function(e){$tw.wiki.addTiddler(e);t.log(\\\"Default tiddlers loaded from database \\\",e)}).catch(function(e){t.log(\\\"Error retrieving StoryList or DefaultTiddlers\\\");t.debug(e)}).then(function(){t.log(\\\"Client side dbs initialized\\\");e()})}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/pouch.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/pouchdb-sycer.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/pouchdb-sycer.js\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";exports.name=\\\"pouchdb-sycer\\\";exports.after=[\\\"pouchdb\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=true;var t=\\\"$:/state/tiddlypouch/sync/status\\\";var e=\\\"$:/state/tiddlypouch/sync/Log\\\";var n=\\\"$:/state/tiddlypouch/sync/Log\\\";var r=\\\"$:/plugins/danielo515/tiddlypouch/config/\\\";exports.startup=function(){var r=new $TPouch.Logger(\\\"PouchSync\\\");function i(t,e,n){if($TPouch.config.debug.isActive()){var i=$tw.wiki.getTiddlerText(t)+\\\"\\\\n\\\";if(typeof e===\\\"object\\\"){if(e.change&&e.change.docs){delete e.change.docs}var o=JSON.stringify(e,null,$tw.config.preferences.jsonSpaces)}else{var o=e}o=n?n+o:o;var c={type:\\\"text/plain\\\",text:i+o,title:t};$tw.wiki.addTiddler(new $tw.Tiddler(c))}r.log(e)}function o(r){return r.put(a()).then(o).catch(function(t){if(t.status==409){o()}else{i(e,t,\\\"===SYNC Error starting===\\\");return t}});function o(o){var c=$TPouch.database._db.sync(r,{live:true,retry:true,filter:\\\"filtered_replication/only_tiddlers\\\"}).on(\\\"change\\\",function(t){i(n,t,\\\"===SYNC Change===\\\")}).on(\\\"paused\\\",function(e){$tw.wiki.setText(t,\\\"text\\\",undefined,\\\"paused\\\");if(e)i(n,e,\\\"===SYNC PAUSED===\\\");else i(n,\\\"===SYNC PAUSED===\\\")}).on(\\\"active\\\",function(){$tw.wiki.setText(t,\\\"text\\\",undefined,\\\"syncing\\\");i(n,\\\"===SYNC ACTIVE===\\\");i(n,\\\"replicate resumed\\\")}).on(\\\"denied\\\",function(t){i(e,t,\\\"===SYNC Denied===\\\")}).on(\\\"complete\\\",function(e){$tw.wiki.setText(t,\\\"text\\\",undefined,\\\"completed\\\");i(n,e,\\\"===SYNC Completed===\\\")}).on(\\\"error\\\",function(n){$tw.wiki.setText(t,\\\"text\\\",undefined,\\\"error\\\");i(e,n,\\\"===SYNC Error===\\\")});$TPouch.database._db.put(a()).catch(function(t){if(t.status!==409){i(e,\\\"Filtered replication may not work, we were unable to store the required doc on the local DB\\\",\\\"===SYNC Error starting===\\\")}});$TPouch.syncHandler=c}}function c(t){var e=$TPouch.config;var r=e.currentDB.getUrl();var o=e.currentDB.getRemoteName();if(!r){i(n,\\\"Entering offline mode\\\");$tw.rootWidget.dispatchEvent({type:\\\"tp-sync-state\\\",param:\\\"offline\\\"});return}$tw.rootWidget.dispatchEvent({type:\\\"tp-sync-state\\\",param:\\\"online\\\"});return new PouchDB(r+o,{auth:t})}function a(){return{_id:\\\"_design/filtered_replication\\\",filters:{only_tiddlers:function(t){return t.hasOwnProperty(\\\"fields\\\")}.toString()}}}$TPouch.startSync=o;$TPouch.newOnlineDB=c}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/pouchdb-sycer.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/startup/utils.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/startup/utils.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nBasic Utils object is created int the pouch startup module\\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";exports.name=\\\"pouchdb-utils\\\";exports.after=[\\\"pouchdb\\\"];exports.before=[\\\"pouchdb-sycer\\\"];exports.platforms=[\\\"browser\\\"];exports.synchronous=true;exports.startup=function(){this.logger=new $TPouch.Logger(\\\"PouchDB\\\");var o=this;var e=$TPouch.database;$TPouch.utils={};$TPouch.utils.remove=function(t){e.get(t).then(function(o){return e.remove(o)}).then(function(e){o.logger.log(\\\"Document removed\\\",e)}).catch(function(e){o.logger.log(e)})};$TPouch.utils.replace=function(t){e.get(t._id).then(function(o){return e.remove(o)}).then(function(){e.put(t).then(function(e){o.logger.log(\\\"Document replaced\\\",e)})}).catch(function(e){o.logger.log(e)})}}})();\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/startup/utils.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/config/SyncFilter\": {\n            \"title\": \"$:/config/SyncFilter\",\n            \"comment\": \"Temprorary workaround until I implement this function in the syncer\",\n            \"text\": \"[is[tiddler]] -[[$:/HistoryList]] -[[$:/Import]] -[[$:/isEncrypted]] -[prefix[$:/status]] -[prefix[$:/state]] -[prefix[$:/temp]] -[prefix[$:/plugins/danielo515/tiddlypouch/]]\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/Buttons/download-basic\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/Buttons/download-basic\",\n            \"text\": \"<$button class=\\\"tc-btn-big-green\\\">\\r\\n<$action-sendmessage $message=\\\"tm-download-file\\\" $param=\\\"$:/plugins/danielo515/tiddlypouch/save/basic\\\" filename=\\\"empty.html\\\"/>\\r\\nDownload Empty {{$:/core/images/save-button}}\\r\\n</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Database\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Database\",\n            \"caption\": \"Database\",\n            \"tags\": \"$:/tags/TiddlyPouch/ControlPanel\",\n            \"text\": \"!!! Database Name {{$:/state/TiddlyPouch/info/databaseName||$:/plugins/danielo515/tiddlypouch/Buttons/info}}\\n\\n<$reveal type=\\\"match\\\" state=\\\"$:/state/TiddlyPouch/info/databaseName\\\" text=\\\"show\\\">\\r\\nThis is the name of your local database. Tiddlers are stored there.\\r\\nYou can have as many databases as you want. Changing this value will make your wiki to save/load\\r\\ntiddlers to/from that database. This requires a ''save and reload'' to take effect.\\r\\n</$reveal>\\n\\nName: {{$:/plugins/danielo515/tiddlypouch/ui/database-name}}\\r\\n@@color:#cc0000;\\r\\n,,//Without this parameter the plugin remains inactive //,,\\r\\n@@\\n\\n!!! Connection Info\\r\\nFill the fields below if you want to synchronize your local database with a remote\\r\\ncouch-like server.\\r\\nThis information will be saved as metadata of the selected local database.\\n\\n~CouchDB URL: {{$:/plugins/danielo515/tiddlypouch/ui/remote-url}}\\r\\n@@color:#c0c0c0;\\r\\n,,//EJ: ~https://someone.cloudant.com //,,\\r\\n@@\\n\\nRemote database name: {{$:/plugins/danielo515/tiddlypouch/ui/remote-name}}\\r\\n@@color:#c0c0c0;\\r\\n,,//Local database will be synced to this database. ''Must exist on server'' if you are not an admin user. //,,\\r\\n@@\\n\\n{{$:/plugins/danielo515/tiddlypouch/ui/save-database-config}}\\n\\n!!!Important information\\r\\nLocal databases are grouped by domain.\\r\\n''If you work'' with your wiki from a file then that particular file @@color:red; will not be able to\\r\\naccess@@ any of the databases created by any wiki accessed online.\\r\\nIf you want to sync databases between a wiki served by http and a local wiki you have to use\\r\\nsome couch backend or export and import the database.\\n\\n!!! Database delete\\r\\nThis will delete your current database.\\r\\nNote that if you are syncing to other devices this will only affects the local database, not the remote ones.\\r\\n@@color:#cc0000;\\r\\nThis action can not be undone!!\\r\\n@@\\r\\nPlease, reload your browser immediately after applying this.\\n\\n<$button message=\\\"tm-pouch-delete-db\\\">Delete database</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Debug\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Debug\",\n            \"caption\": \"Debug\",\n            \"tags\": \"$:/tags/TiddlyPouch/ControlPanel\",\n            \"text\": \"\\r\\nActivate logging if you are experiencing problems while syncing or you are curious about it.\\n\\n\\\"\\\"\\\"\\r\\n<$checkbox tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/Debug/Active\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\"> Debug mode</$checkbox>\\r\\n<$checkbox tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/Debug/Verbose\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\"> Verbose mode</$checkbox>\\r\\n\\\"\\\"\\\"\\n\\n<$button message=\\\"tm-TP-config-updateDebug\\\">Save Config</$button>\\n\\n!!! Sync Log\\n\\n<$button>\\r\\n<$action-navigate $to=\\\"$:/state/tiddlypouch/sync/Log\\\"/>\\r\\nOpen Log\\r\\n</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Download\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ControlPanel/Download\",\n            \"caption\": \"Download\",\n            \"tags\": \"$:/tags/TiddlyPouch/ControlPanel\",\n            \"text\": \"Here you have different methods of download this wiki.\\n\\n!!Save config\\r\\nThis downloads this wiki without any tiddler created by the user. ''Useful if'':\\n\\n* You have changed any setting and you want to persist those changes.\\r\\n* You want to sync this wiki from the server in another computer/browser.\\r\\n* You have installed another plugin and need to restart.\\r\\n* You want to start again without any tiddler but keeping your current configuration\\n\\n{{$:/plugins/danielo515/tiddlypouch/Buttons/download-empty}}\\n\\n!!Pack database\\r\\nThis option packs the database currently in use into a system tiddler and then it \\r\\ndownloads the wiki with it. ''Useful'' if you want to use this wiki in a different computer \\r\\nor browser.\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/remote-user\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/remote-user\",\n            \"text\": \"<$edit-text tag=\\\"input\\\" index=\\\"remote.user\\\" tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/selected_database\\\"  default=\\\"\\\"/>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/remote-name\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/remote-name\",\n            \"text\": \"<$edit-text tag=\\\"input\\\" index=\\\"remote.name\\\" tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/selected_database\\\" default=\\\"\\\"/>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/remote-url\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/remote-url\",\n            \"text\": \"<$edit-text tag=\\\"input\\\" index=\\\"remote.url\\\" tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/selected_database\\\"  default=\\\"\\\"/>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/save-database-config\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/save-database-config\",\n            \"text\": \"<$button message=\\\"tm-TP-config-updateSelectedDB\\\">Save Config</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ControlPanel\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ControlPanel\",\n            \"caption\": \"~TiddlyPouch\",\n            \"tags\": \"$:/tags/ControlPanel\",\n            \"text\": \"<div class=\\\"tc-tiddlypouch-control-panel\\\">\\r\\n<<tabs \\\"[all[shadows]tag[$:/tags/TiddlyPouch/ControlPanel]]\\\" \\\"$:/plugins/danielo515/tiddlypouch/ControlPanel/Download\\\" \\\"$:/state/TiddlyPouch/tabs\\\">>\\r\\n</div>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/Buttons/download-empty\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/Buttons/download-empty\",\n            \"text\": \"<$button class=\\\"tc-btn-big-green\\\">\\r\\n<$action-sendmessage $message=\\\"tm-download-file\\\" $param=\\\"$:/plugins/danielo515/tiddlypouch/save/empty\\\" filename=\\\"empty.html\\\"/>\\r\\nSave config {{$:/core/images/save-button}}\\r\\n</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/save/empty\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/save/empty\",\n            \"text\": \"\\\\define saveTiddlerFilter()\\r\\n[is[system]] -[prefix[$:/state/]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] +[sort[title]]\\r\\n\\\\end\\r\\n\\\\define savingEmpty()\\r\\nyes\\r\\n\\\\end\\r\\n{{$:/core/templates/tiddlywiki5.html}}\\n\\n\\r\\n\"\n        },\n        \"GettingStarted\": {\n            \"title\": \"GettingStarted\",\n            \"text\": \"\\\\define lingo-base() $:/language/ControlPanel/Basics/\\r\\nWelcome to ~NoteSelf and the ~TiddlyWiki community\\n\\nYou can start using your notebook right NOW. Go ahead and collect ideas, make lists, take notes, start a diary...\\r\\nYou can have as many notebooks as you want.\\r\\nJust change the `Notebook Name` and hit the save config button. New notes will be saved to that notebook.\\n\\nIn case you want automatic synchronization fill the fields of the synchronization section below\\n\\n!! Setup this Notebook\\n\\n<div class=\\\"tc-control-panel\\\">\\n\\n|<<tiddlypouch-tab \\\"Notebook Name\\\" \\\"Database\\\" >> |{{$:/plugins/danielo515/tiddlypouch/ui/database-name}} |\\r\\n|! Sync configuration|<|\\r\\n|<<tiddlypouch-tab \\\"CouchDB URL\\\" \\\"Database\\\" >> |{{$:/plugins/danielo515/tiddlypouch/ui/remote-url}} |\\r\\n|<<tiddlypouch-tab \\\"Remote database name\\\" \\\"Database\\\" >> |{{$:/plugins/danielo515/tiddlypouch/ui/remote-name}} |\\r\\n| {{$:/plugins/danielo515/tiddlypouch/ui/save-database-config}} |<|\\r\\n|<$link to=\\\"$:/SiteTitle\\\">Page title</$link> |<$edit-text tiddler=\\\"$:/SiteTitle\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\r\\n|<$link to=\\\"$:/DefaultTiddlers\\\"><<lingo DefaultTiddlers/Prompt>></$link> |<<lingo DefaultTiddlers/TopHint>><br> <$edit tag=\\\"textarea\\\" tiddler=\\\"$:/DefaultTiddlers\\\"/><br>//<<lingo DefaultTiddlers/BottomHint>>// |\\r\\n</div>\\n\\nSee the [[control panel|$:/ControlPanel]] for more options.\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/Buttons/info\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/Buttons/info\",\n            \"comment\": \"this tiddler should be used as a transclude template\",\n            \"text\": \"<$reveal type=\\\"nomatch\\\" state={{!!title}} text=\\\"show\\\">\\r\\n<$button set={{!!title}} setTo=\\\"show\\\" class=\\\"tc-btn-invisible\\\"><span style=\\\"top:-9px; position: relative\\\">{{$:/core/images/help}}</span></$button>\\r\\n</$reveal><$reveal type=\\\"match\\\" state={{!!title}} text=\\\"show\\\">\\r\\n<$button set={{!!title}} class=\\\"tc-btn-invisible\\\" setTo=\\\"hide\\\"><span style=\\\"top:-9px; position: relative\\\">{{$:/core/images/help}}</span></$button>\\r\\n</$reveal>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/Installation\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/Installation\",\n            \"created\": \"20140901120057909\",\n            \"modified\": \"20160730120057909\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"# Open your wiki in a browser\\r\\n# Drag this link into your wiki\\r\\n#> [[$:/plugins/danielo515/tiddlypouch]]\\r\\n# Save your wiki\\r\\n\"\n        },\n        \"$:/language/TiddlyPouch/Delete-DB\": {\n            \"title\": \"$:/language/TiddlyPouch/Delete-DB\",\n            \"text\": \"You are going to delete database named <<database>>. Please type 'delete' and click confirm.\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/language/revisions/Hint\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/language/revisions/Hint\",\n            \"text\": \"Show current tiddler revisions\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/language/revisions/Caption\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/language/revisions/Caption\",\n            \"text\": \"Show revisions\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/save/basic\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/save/basic\",\n            \"text\": \"\\\\define saveTiddlerFilter()\\r\\n[[$:/core]] [prefix[$:/plugins/danielo515/tiddlypouch/config/]] [[$:/isEncrypted]] [[$:/plugins/danielo515/tiddlypouch]] [[$:/themes/tiddlywiki/snowwhite]] [[$:/themes/tiddlywiki/vanilla]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] +[sort[title]]\\r\\n\\\\end\\r\\n\\\\define savingEmpty()\\r\\nyes\\r\\n\\\\end\\r\\n{{$:/core/templates/tiddlywiki5.html}}\"\n        },\n        \"$:/SiteTitle\": {\n            \"title\": \"$:/SiteTitle\",\n            \"text\": \"My Notebook\"\n        },\n        \"$:/state/tiddlypouch/sync/errors\": {\n            \"title\": \"$:/state/tiddlypouch/sync/errors\",\n            \"text\": \"\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/sync-flag\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/sync-flag\",\n            \"text\": \"<$reveal type=\\\"match\\\" state=\\\"$:/state/tiddlypouch/sync/status\\\" text=\\\"offline\\\">\\r\\n<$button message=\\\"tm-login\\\" >Offline</$button>\\r\\n</$reveal>\\n\\n<$reveal type=\\\"nomatch\\\" state=\\\"$:/state/tiddlypouch/sync/status\\\" text=\\\"offline\\\">\\r\\n<$button class=\\\"tc-btn-invisible\\\">\\r\\n<$reveal type=\\\"match\\\" state=\\\"$:/state/tiddlypouch/sync/status\\\" text=\\\"error\\\">{{$:/plugins/danielo515/tiddlypouch/images/cloud-error}}</$reveal>\\r\\n<$reveal type=\\\"match\\\" state=\\\"$:/state/tiddlypouch/sync/status\\\" text=\\\"paused\\\">{{$:/plugins/danielo515/tiddlypouch/images/cloud-ok}}</$reveal>\\r\\n<$reveal type=\\\"match\\\" state=\\\"$:/state/tiddlypouch/sync/status\\\" text=\\\"syncing\\\">{{$:/plugins/danielo515/tiddlypouch/images/cloud-spinning}}</$reveal>\\r\\n</$button>\\r\\n</$reveal>\"\n        },\n        \"$:/state/tiddlypouch/sync/Log\": {\n            \"title\": \"$:/state/tiddlypouch/sync/Log\",\n            \"text\": \"\\r\\n\"\n        },\n        \"$:/state/tiddlypouch/sync/status\": {\n            \"title\": \"$:/state/tiddlypouch/sync/status\",\n            \"text\": \"offline\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/Stylesheet/ControlPanel\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/Stylesheet/ControlPanel\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"text\": \".tc-tiddlypouch-control-panel input {\\r\\n    width: 100%;\\r\\n}\\n\\n.tc-tiddlypouch-control-panel input[type=\\\"checkbox\\\"], .tc-tiddlypouch-control-panel-checkbox {\\r\\n    width: auto;\\r\\n}\\n\\n.tc-tiddlypouch-control-panel .tc-type-selector input, .tc-control-panel table .tc-type-selector input {\\r\\n    width: auto;\\r\\n}\\n\\n.tc-plugin-reload-warning svg {\\r\\n    height: 1em;\\r\\n}\"\n        },\n        \"$:/core/ui/PageTemplate/pluginreloadwarning\": {\n            \"title\": \"$:/core/ui/PageTemplate/pluginreloadwarning\",\n            \"tags\": \"$:/tags/PageTemplate\",\n            \"text\": \"\\\\define lingo-base() $:/language/\\n\\n<$list filter=\\\"[has[plugin-type]haschanged[]!plugin-type[import]limit[1]]\\\">\\n\\n<$reveal type=\\\"nomatch\\\" state=\\\"$:/temp/HidePluginWarning\\\" text=\\\"yes\\\">\\n\\n<div class=\\\"tc-plugin-reload-warning\\\">\\n\\n<$set name=\\\"tv-config-toolbar-class\\\" value=\\\"\\\">\\n\\nYou have just installed a plugin. Please wait until changes has been saved (<span class=\\\"tc-dirty-indicator\\\">{{$:/core/images/done-button}}</span>) and reload the window <$button set=\\\"$:/temp/HidePluginWarning\\\" setTo=\\\"yes\\\" class=\\\"tc-btn-invisible\\\">{{$:/core/images/close-button}}</$button>\\n\\n</$set>\\n\\n</div>\\n\\n</$reveal>\\n\\n</$list>\"\n        },\n        \"$:/core/ui/TiddlerInfo\": {\n            \"title\": \"$:/core/ui/TiddlerInfo\",\n            \"text\": \"<$macrocall $name=\\\"tabs-state\\\" tabsList=\\\"[all[shadows+tiddlers]tag[$:/tags/TiddlerInfo]!has[draft.of]]\\\" state=<<tiddlerInfoTabState>> default={{$:/config/TiddlerInfo/Default}}/>\"\n        },\n        \"$:/core/ui/ViewTemplate\": {\n            \"title\": \"$:/core/ui/ViewTemplate\",\n            \"text\": \"\\\\define InfoTabState()\\r\\n$:/state/infotab/$(currentTiddler)$\\r\\n\\\\end\\r\\n\\\\define frame-classes()\\r\\ntc-tiddler-frame tc-tiddler-view-frame $(missingTiddlerClass)$ $(shadowTiddlerClass)$ $(systemTiddlerClass)$ $(tiddlerTagClasses)$\\r\\n\\\\end\\r\\n\\\\define folded-state()\\r\\n$:/state/folded/$(currentTiddler)$\\r\\n\\\\end\\r\\n<$set name=\\\"storyTiddler\\\" value=<<currentTiddler>>><$set name=\\\"tiddlerInfoState\\\" value=<<qualify \\\"$:/state/popup/tiddler-info\\\">> ><$set name=\\\"tiddlerInfoTabState\\\" value=<<InfoTabState>> ><$tiddler tiddler=<<currentTiddler>>><div class=<<frame-classes>>><$list filter=\\\"[all[shadows+tiddlers]tag[$:/tags/ViewTemplate]!has[draft.of]]\\\" variable=\\\"listItem\\\"><$transclude tiddler=<<listItem>>/></$list>\\r\\n</div>\\r\\n</$tiddler></$set></$set></$set>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/buttons/revisions\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/buttons/revisions\",\n            \"caption\": \"{{$:/plugins/danielo515/tiddlypouch/language/revisions/Caption}}\",\n            \"description\": \"{{$:/plugins/danielo515/tiddlypouch/language/revisions/Hint}}\",\n            \"tags\": \"$:/tags/ViewToolbar\",\n            \"text\": \"<$button popup=<<tiddlerInfoState>> tooltip={{$:/plugins/danielo515/tiddlypouch/language/revisions/Hint}} aria-label={{$:/plugins/danielo515/tiddlypouch/language/revisions/Caption}} class=<<tv-config-toolbar-class>>>\\r\\n<$action-setfield $tiddler=<<tiddlerInfoTabState>> text=\\\"$:/plugins/danielo515/tiddlypouch/ui/revisions\\\"/>\\r\\n<$action-sendmessage $message=\\\"tm-tp-load-revisions\\\" $param=<<currentTiddler>>/>\\r\\n<$list filter=\\\"[<tv-config-toolbar-icons>prefix[yes]]\\\">\\r\\n{{$:/plugins/danielo515/tiddlypouch/images/revisions}}\\r\\n</$list>\\r\\n<$list filter=\\\"[<tv-config-toolbar-text>prefix[yes]]\\\">\\r\\n<span class=\\\"tc-btn-text\\\"><$text text={{$:/plugins/danielo515/tiddlypouch/language/revisions/Caption}}/></span>\\r\\n</$list>\\r\\n</$button>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/revisions/review-tabs\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/revisions/review-tabs\",\n            \"list-after\": \"$:/core/ui/ViewTemplate/title\",\n            \"tags\": \"$:/tags/ViewTemplate\",\n            \"text\": \"<$list filter=\\\"[prefix[$:/temp/revision:]suffix<currentTiddler>!field:title<currentTiddler>limit[1]]\\\" variable=\\\"ui-null\\\">\\r\\n<$macrocall $name=\\\"revision-tabs\\\"\\r\\ntabsList=\\\"[prefix[$:/temp/revision:]suffix<currentTiddler>]\\\"\\r\\ndefault=<<currentTiddler>>\\r\\nstate=\\\"$:/state/review/tabs\\\"\\r\\nclass=\\\"tc-review-tabs\\\"\\r\\ntemplate=\\\"$:/plugins/danielo515/tiddlypouch/ui/revisions/transclude-template\\\" />\\r\\n</$list>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/revisions/styles\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/revisions/styles\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"text\": \"\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline macrocallblock\\n\\n.tc-review-tabs {  \\r\\n      line-height: 22px; \\r\\n}\\n\\n/* avoid nested view template be moved */\\r\\n.tc-review-tabs .tc-tiddler-frame {\\r\\n    padding-top:0px;\\r\\n    padding-bottom: 0px;\\r\\n    margin-bottom: 0px;\\r\\n    box-shadow: none;\\r\\n    border: none;\\r\\n}\\n\\n.tc-review-tabs .tc-titlebar {\\r\\n    display: none;\\r\\n}\\n\\n/* This block adjusts the margins inside the review tabs\\r\\n   in the different breakpoints\\r\\n*/\\n\\n@media (max-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\\r\\n    .tc-tab-set.tc-review-tabs{\\r\\n        margin-left: -14px;\\r\\n    }\\r\\n}\\n\\n@media (min-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\\n\\n    .tc-tab-set.tc-review-tabs{\\r\\n        margin-left: -43px;\\r\\n    }\\n\\n}\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/macros/revision-tabs\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/macros/revision-tabs\",\n            \"tags\": \"$:/tags/Macro\",\n            \"text\": \"\\\\define revision-tabs(tabsList,default,state:\\\"$:/state/tab\\\",class,template)\\r\\n<div class=\\\"tc-tab-set $class$\\\">\\r\\n<div class=\\\"tc-tab-buttons $class$\\\">\\r\\n<$button set=<<qualify \\\"$state$\\\">> setTo=<<currentTiddler>> default=\\\"$default$\\\" selectedClass=\\\"tc-tab-selected\\\" tooltip={{!!tooltip}}>\\r\\n<$action-setfield $tiddler=<<folded-state>> text=\\\"show\\\"/>\\r\\n<$set name=\\\"tv-wikilinks\\\" value=\\\"no\\\">\\r\\n<!-- TODO: localization -->\\r\\nCurrent\\r\\n</$set></$button><$list filter=\\\"$tabsList$ -[<currentTiddler>]\\\" variable=\\\"currentTab\\\"><$set name=\\\"save-currentTiddler\\\" value=<<currentTiddler>>><$tiddler tiddler=<<currentTab>>><$button set=<<qualify \\\"$state$\\\">> setTo=<<currentTab>> default=\\\"$default$\\\" selectedClass=\\\"tc-tab-selected\\\" tooltip={{!!tooltip}}>\\r\\n<$tiddler tiddler=<<save-currentTiddler>>>\\r\\n<$action-setfield $tiddler=<<folded-state>> text=\\\"hide\\\"/>\\r\\n<$set name=\\\"tv-wikilinks\\\" value=\\\"no\\\">\\r\\n<$list filter=\\\"[<currentTab>removeprefix[$:/temp/revision:]removesuffix<currentTiddler>]\\\" variable=\\\"currentTab\\\">\\r\\n<$macrocall $name=\\\"currentTab\\\" $type=\\\"text/plain\\\" $output=\\\"text/plain\\\"/>\\r\\n</$list>\\r\\n</$set></$tiddler></$button></$tiddler></$set></$list>\\r\\n</div>\\r\\n<div class=\\\"tc-tab-divider $class$\\\"/>\\r\\n<div class=\\\"tc-tab-content $class$\\\">\\r\\n<$list filter=\\\"$tabsList$\\\" variable=\\\"currentTab\\\">\\n\\n<$reveal type=\\\"match\\\" state=<<qualify \\\"$state$\\\">> text=<<currentTab>> default=\\\"$default$\\\">\\n\\n<$transclude tiddler=\\\"$template$\\\" mode=\\\"block\\\">\\n\\n<$transclude tiddler=<<currentTab>> mode=\\\"block\\\"/>\\n\\n</$transclude>\\n\\n</$reveal>\\n\\n</$list>\\r\\n</div>\\r\\n</div>\\r\\n\\\\end\\r\\n\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/revisions/transclude-template\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/revisions/transclude-template\",\n            \"text\": \"<!-- This template should be used with the tabs macro  -->\\r\\n<$list filter=\\\"[is[current]!field:title<currentTab>]\\\">\\r\\n<$tiddler tiddler=<<currentTab>>>\\r\\n<$transclude tiddler=\\\"$:/core/ui/ViewTemplate\\\"/>\\r\\n</$tiddler>\\r\\n</$list>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/revisions\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/revisions\",\n            \"caption\": \"Revisions\",\n            \"tags\": \"$:/tags/TiddlerInfo\",\n            \"text\": \"<$button message=\\\"tm-tp-load-revisions\\\" param={{!!title}}>\\r\\n    Reload revisions\\r\\n</$button>\\r\\n<table>\\r\\n<$list filter=\\\"[{!!title}addprefix[$:/temp/revisions:]]\\\" variable=\\\"rev-store\\\">\\r\\n    <$list filter=\\\"[<rev-store>indexes[]nsort[]]\\\" variable=\\\"index\\\">\\r\\n        <$list filter=\\\"[<rev-store>getindex<index>]\\\" variable=\\\"revision\\\">\\r\\n            <tr><td><$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">\\r\\n                <$action-sendmessage $message=\\\"tm-tp-load-certain-revision\\\" $param={{!!title}} revision=<<revision>>/>\\r\\n                <$text text=<<revision>>/>\\r\\n            </$button>\\r\\n            </td></tr>\\r\\n        </$list>\\r\\n    </$list>\\r\\n</$list>\\r\\n</table>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/macros/tabs-state\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/macros/tabs-state\",\n            \"tags\": \"$:/tags/Macro\",\n            \"text\": \"\\\\define tabs-state(tabsList,default,state:\\\"$:/state/tab\\\",class,template)\\r\\n<div class=\\\"tc-tab-set $class$\\\">\\r\\n<div class=\\\"tc-tab-buttons $class$\\\">\\r\\n<$list filter=\\\"$tabsList$\\\" variable=\\\"currentTab\\\">\\r\\n<$button set=<<tiddlerInfoTabState>> setTo=<<currentTab>> default=\\\"$default$\\\" selectedClass=\\\"tc-tab-selected\\\">\\r\\n<$transclude tiddler=<<currentTab>> field=\\\"caption\\\">\\r\\n<$macrocall $name=\\\"currentTab\\\" $type=\\\"text/plain\\\" $output=\\\"text/plain\\\"/>\\r\\n</$transclude>\\r\\n</$button>\\r\\n</$list>\\r\\n</div><div class=\\\"tc-tab-divider $class$\\\"/><div class=\\\"tc-tab-content $class$\\\">\\r\\n<$list filter=\\\"$tabsList$\\\" variable=\\\"currentTab\\\">\\n\\n<$reveal type=\\\"match\\\" state=<<tiddlerInfoTabState>> text=<<currentTab>> default=\\\"$default$\\\">\\n\\n<$transclude tiddler=\\\"$template$\\\" mode=\\\"block\\\">\\n\\n<$transclude tiddler=<<currentTab>> mode=\\\"block\\\"/>\\n\\n</$transclude>\\n\\n</$reveal>\\n\\n</$list>\\r\\n</div>\\r\\n</div>\\r\\n\\\\end\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/macros/navigate-to-controlPanel-tab\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/macros/navigate-to-controlPanel-tab\",\n            \"tags\": \"$:/tags/Macro\",\n            \"text\": \"\\\\define control-panel-tab(caption target)\\r\\n<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">\\r\\n    <$action-setfield $tiddler=\\\"$:/state/tab-1749438307\\\" text=\\\"$target$\\\" />\\r\\n    <$action-navigate $to=\\\"$:/ControlPanel\\\" />\\r\\n    $caption$\\r\\n</$button>\\r\\n\\\\end\\n\\n\\\\define tiddlypouch-tab(caption target)\\r\\n<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">\\r\\n    <$action-setfield $tiddler=\\\"$:/state/tab-1749438307\\\" text=\\\"$:/plugins/danielo515/tiddlypouch/ControlPanel\\\" />\\r\\n    <$action-setfield $tiddler=\\\"$:/state/TiddlyPouch/tabs--1566775042\\\" text=\\\"$:/plugins/danielo515/tiddlypouch/ControlPanel/$target$\\\"/>\\r\\n    <$action-navigate $to=\\\"$:/ControlPanel\\\" />\\r\\n    <$text text=\\\"$caption$\\\"/>\\r\\n</$button>\\r\\n\\\\end\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/database-name\": {\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/database-name\",\n            \"text\": \"<div class=\\\"tc-type-selector\\\">\\r\\n<$edit-text tiddler=\\\"$:/plugins/danielo515/tiddlypouch/config/selected_database\\\" index=\\\"name\\\" tag=\\\"input\\\" default=\\\"\\\" focusPopup=<<qualify \\\"$:/state/TyddlyPouch/database-popup\\\">> class=\\\"tc-popup-handle\\\"/>\\r\\n<$button popup=<<qualify \\\"$:/state/TyddlyPouch/database-popup\\\">> class=\\\"tc-btn-invisible tc-btn-dropdown\\\" tooltip=\\\"list existing databases\\\" aria-label=\\\"list existing databases\\\">{{$:/core/images/down-arrow}}</$button>\\n\\n\\r\\n<div class=\\\"tc-block-dropdown-wrapper\\\">\\r\\n<$reveal state=<<qualify \\\"$:/state/TyddlyPouch/database-popup\\\">> type=\\\"nomatch\\\" text=\\\"\\\" default=\\\"\\\">\\r\\n<div class=\\\"tc-block-dropdown tc-edit-type-dropdown\\\">\\r\\n<$list filter=\\\"[list[$:/plugins/danielo515/tiddlypouch/config/database_names]]\\\">\\r\\n<div class=\\\"tc-dropdown-item\\\">\\r\\n<$button class=\\\"tc-btn-invisible\\\" message=\\\"tm-TP-config-selectedDb\\\" param={{!!title}}>\\r\\n<$text text={{!!title}}/>\\r\\n</$button>\\r\\n</div>\\r\\n</$list>\\r\\n</div>\\r\\n</$reveal>\\r\\n</div>\\r\\n</div>\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/ui/config.js\": {\n            \"text\": \"/*\\\\\\ntype: application/javascript\\ntitle: $:/plugins/danielo515/tiddlypouch/ui/config.js\\nmodule-type: library\\n\\nLinks the user interface with the configuration methods \\n\\n@preserve\\n\\n\\\\*/\\n(function(){\\\"use strict\\\";var e=\\\"$:/plugins/danielo515/tiddlypouch/config/Debug\\\";var t=e+\\\"/Active\\\";var i=e+\\\"/Verbose\\\";var d=\\\"$:/plugins/danielo515/tiddlypouch/config/database_names\\\";var a=\\\"$:/plugins/danielo515/tiddlypouch/config/selected_database\\\";var n=\\\"$:/plugins/danielo515/tiddlypouch/ui/sync-flag\\\";var o=require(\\\"$:/plugins/danielo515/tiddlypouch/utils\\\");exports.refreshUI=function T(e){s(e);g(e.databases[e.selectedDbId]);r();u();c();l()};exports.handlers={};function r(e){var t=$tw.wiki.getTiddler(n);if(e===\\\"offline\\\"||!$TPouch.config.currentDB.getUrl()){return $tw.wiki.addTiddler(new $tw.Tiddler(t,{tags:[]}))}$tw.wiki.addTiddler(new $tw.Tiddler(t,{tags:[\\\"$:/tags/PageControls\\\"]}))}exports.setSyncFlag=r;function l(){var e=\\\"<<tiddlypouch-tab \\\"+$TPouch.config.currentDB.name+\\\" Database >>\\\";$tw.wiki.addTiddler({title:\\\"$:/SiteSubtitle\\\",text:e})}function c(){var e=$TPouch.config.currentDB.getUrl();var t=$TPouch.config.currentDB.getRemoteName();var i=\\\"Login to remote database <b>\\\"+t+\\\"</b> at: \\\"+e;$tw.wiki.addTiddler({title:\\\"$:/language/LoginToTiddlySpace\\\",text:i})}function u(){var e=$TPouch.config.getAllDBNames();$tw.wiki.addTiddler({title:d,list:e,text:\\\"{{!!list}}\\\"})}exports.handlers.updateDebug=function(e){var d=$tw.wiki.getTiddlerText(t)===\\\"yes\\\";var a=$tw.wiki.getTiddlerText(i)===\\\"yes\\\";var n=$TPouch.config.readConfigTiddler();n.debug={active:d,verbose:a};$TPouch.config.update(n)};function s(e){$tw.wiki.addTiddler(new $tw.Tiddler({title:t,text:o.boolToHuman(e.debug.active)}));$tw.wiki.addTiddler(new $tw.Tiddler({title:i,text:o.boolToHuman(e.debug.verbose)}))}exports.handlers.updateDbConfig=function(e){var t=$TPouch.config.readConfigTiddler();var i=$tw.wiki.getTiddlerData(a);t.selectedDbId=i.name;t.databases[i.name]=o.plainToNestedObject(i);$TPouch.config.update(t)};exports.handlers.databaseHasBeenSelected=function(e){var t=e.param;var i=$TPouch.config.getDatabaseConfig(t);g(i)};function g(e){var t=o.flattenObject(e);$tw.wiki.addTiddler(new $tw.Tiddler({title:a,type:\\\"application/json\\\",text:JSON.stringify(t)}))}})();\",\n            \"type\": \"application/javascript\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/ui/config.js\",\n            \"module-type\": \"library\"\n        },\n        \"$:/plugins/danielo515/tiddlypouch/utils\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/danielo515/tiddlypouch/utils\\ntype: application/javascript\\nmodule-type: library\\n\\nCollection of functions to help with some repetitive tasks.\\nIt is different from the utils created at startup, which are tiddlypoucyh focused\\nThis one should be required in order to be used.\\n\\n\\n\\n@preserve\\n\\n\\\\*/\\n\\\"use strict\\\";var utils={boolToHuman:boolToHuman,plainToNestedObject:plainToNestedObject,flattenObject:flattenObject,saveAsJsonTiddler:saveAsJsonTiddler};module.exports=utils;function saveAsJsonTiddler(e,t,n){var o=n?$tw.config.preferences.jsonSpaces:null;$tw.wiki.addTiddler(new $tw.Tiddler({title:e,type:\\\"application/json\\\",text:JSON.stringify(t,null,o)}))}function flattenObject(e){var t={};var n;for(var o in e){if(!e.hasOwnProperty(o)){continue}if(typeof e[o]===\\\"object\\\"){n=flattenObject(e[o]);for(var i in n){if(!n.hasOwnProperty(i)){continue}t[o+(!!isNaN(i)?\\\".\\\"+i:\\\"\\\")]=n[i]}}else{t[o]=e[o]}}return t}function plainToNestedObject(e){var t={};$tw.utils.each(e,function(e,o){n(t,o.split(\\\".\\\"),e)});return t;function n(e,t,n){t=t.slice();var o=t.pop();var i=t.reduce(function(e,t){e[t]=e[t]||{};return e[t]},e);i[o]=n;return e}}function boolToHuman(e){return e?\\\"yes\\\":\\\"no\\\"}\",\n            \"title\": \"$:/plugins/danielo515/tiddlypouch/utils\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        }\n    }\n}"
  }
]